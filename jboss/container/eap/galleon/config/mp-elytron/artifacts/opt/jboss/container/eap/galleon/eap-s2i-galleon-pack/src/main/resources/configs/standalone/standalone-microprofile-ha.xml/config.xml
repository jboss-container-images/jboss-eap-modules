<?xml version="1.0" ?>

<config xmlns="urn:jboss:galleon:config:1.0" name="standalone-microprofile-ha.xml" model="standalone">
    <layers>
        <!-- we already have all required in default config -->
        <!-- Although logically correct, galleon doesn't actually support excluding from model -->
        <!-- This is harmless, keeping the exclusion commented for reference until GAL-308 is fixed -->
        <!--<exclude name="operator-required"/>-->
        <include name="amq6-rar"/>
    </layers>

     <!-- No sso packages for JDK17 techpreview -->
    <!-- <feature-group name="sso"/> -->

    <!-- JDK 17 -->
    <exclude feature-id="core-service.management.security-realm:security-realm=ApplicationRealm"/>
    <exclude feature-id="core-service.management.security-realm:security-realm=ManagementRealm"/>

    <!-- management -->
    <!-- JDK 17, do not exclude identity -->
    <!--<exclude spec="core-service.management.access.identity"/>-->
    <feature spec="core-service.management.management-interface.http-interface">
        <param name="socket-binding" value="management-http"/>
        <unset param="http-authentication-factory"/>
        <feature spec="core-service.management.management-interface.http-interface.http-upgrade">
            <param name="sasl-authentication-factory" value="management-sasl-authentication"/>
        </feature>
    </feature>
    <exclude spec="subsystem.core-management"/>
    <feature-group name="os-management"/>

    <!-- messaging -->
    <feature spec="subsystem.messaging-activemq"/>
    <feature-group name="os-messaging"/>

    <!-- logging -->
    <exclude feature-id="subsystem.logging.pattern-formatter:pattern-formatter=PATTERN"/>
    <exclude feature-id="subsystem.logging.periodic-rotating-file-handler:periodic-rotating-file-handler=FILE"/>
    <feature-group name="os-logging"/>

    <!-- datasources -->
    <!-- We are not keeping the ExampleDS in the config -->
    <exclude feature-id="subsystem.datasources.data-source:data-source=ExampleDS"/>
    <feature spec="subsystem.ee.service.default-bindings">
        <unset param="datasource"/>
    </feature>

    <!-- elytron -->
    <feature-group name="os-elytron"/>

    <!-- clustering -->
    <exclude spec="subsystem.infinispan"/>
    <feature-group name="os-clustering"/>

    <!-- legacy security -->
    <!-- JDK 17 excluded fully -->
    <exclude feature-id="subsystem.security.security-domain:security-domain=jaspitest"/>
    <exclude feature-id="subsystem.security.security-domain:security-domain=other"/>
    <exclude feature-id="subsystem.security.security-domain:security-domain=jboss-web-policy"/>
    <exclude feature-id="subsystem.security.security-domain:security-domain=jboss-ejb-policy"/>
    <exclude spec="subsystem.security"/>
    <!-- transactions -->
    <feature-group name="tx-recovery"/>

    <!-- undertow -->
    <exclude feature-id="subsystem.undertow.server.https-listener:server=default-server,https-listener=https"/>

    <!-- web-services -->
    <feature spec="subsystem.webservices">
        <param name="modify-wsdl-address" value="true"/>
        <param name="wsdl-host" value="jbossws.undefined.host"/>
    </feature>

    <feature-group name="os-socket"/>

    <feature-group name="os-undertow-elytron"/>

</config>
